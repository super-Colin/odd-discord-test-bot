require("dotenv").config();const Discord=require("discord.js"),mongoUtil=require("./utilities/mongodb.utility"),reminderModel=require("./models/reminder.model"),DiscordClient=new Discord.Client,seedReminder={key:"value",num:123,boolean:!0};mongoUtil.connectDB(async err=>{if(err)throw err;const db=await mongoUtil.getDB(),reminders=db.collection("reminders");try{const newReminder=await Reminders.createReminder(reminders,seedReminder),listReminders=await Reminders.getReminders(reminders)}catch(err){throw console.log("connect error"),err}}),DiscordClient.on("ready",()=>{DiscordClient.user.setActivity("Russian Roulette")}),DiscordClient.on("message",async message=>{if(message.author.bot)return;if(0!==message.content.indexOf(process.env.prefix))return;const args=message.content.slice(process.env.prefix.length).trim().split(/ +/g),command=args.shift().toLowerCase();if("remindme"===command){if("help"===args[0])return message.channel.send("This commands set a reminder for you. Pass an amount of minutes until you should be reminded and a message for yourself. Example:"),void message.channel.send(process.env.prefix+"remindme 15 Check the oven");const userToRemind=message.author,msg=args.slice(1).join(" "),now=Math.floor((new Date).getTime()/1e3),minutesFromNowInMillisec=Math.floor(6e4*args[0]),remindTime=now+minutesFromNowInMillisec;message.channel.send("now : "+now),message.channel.send("remind: "+remindTime);const reminder={reminder:!0,eventType:"remindme",remindWho:userToRemind,dateToRemind:remindTime,message:msg};reminder.save().then(result=>console.log(result)).catch(err=>console.log(err)),message.reply("Reminder saved.. you wont be reminded yet though..")}}),DiscordClient.login(process.env.DISCORD_TOKEN);